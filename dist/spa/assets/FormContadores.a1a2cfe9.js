import{Q as F}from"./QSpace.5039b404.js";import{c4 as w,cj as Q,r as i,w as B,aT as c,ad as p,ab as N,bo as R,F as S,aZ as T,ae as l,W as y,ak as j,f as d,c6 as I,c7 as b,cc as K}from"./index.fe61ee2b.js";import{Q as O}from"./QForm.831263eb.js";import{u as U}from"./use-quasar.6e3d8175.js";import{u as D}from"./ReCaptchaVuePlugin.1e4a9531.js";import{_ as L}from"./plugin-vue_export-helper.21dcd24c.js";const W={class:"cuerpo"},Z=["for"],$={class:"botones-submit"},z={__name:"FormContadores",props:{equipo:{type:Object,required:!0}},emits:"volver",setup(h,{emit:k}){const u=k,r=h;w(),Q();const{executeRecaptcha:x}=D(),m=i(null),f=i(0),_=i(r.equipo.contadores),a=U(),n=i({}),v=()=>{console.log("Reset form"),m.value.resetValidation(),n.value={},f.value++},q=()=>{v(),u("volver")},V=async()=>{let s=Object.entries(n.value).map(([t,e])=>({id:t,actual:e,actual:e}));a.loading.show();try{const t=await x("submit_form"),e=await K.post("/contadores.php",{recaptchaToken:t,tkn:r.equipo.TKN,con:s});console.log("Verificaci\xF3n",e.data),e.data.success?(s.forEach(({id:o,actual:C})=>{const g=r.equipo.contadores.find(E=>E.id==o);g&&(g.lectura=C)}),a.notify({color:"green",position:"top",message:"Contadores modificados correctamente",icon:"check_circle"}),v(),u("volver")):a.notify({color:"red",position:"top",message:"Error al modificar contadores",icon:"report_problem"})}catch(t){console.error("Error:",t),a.notify({color:"red",position:"top",message:"Error al modificar contadores",icon:"report_problem"})}a.loading.hide()};return B(()=>r.equipo,s=>{console.log("props",r.equipo),_.value=s.contadores}),(s,t)=>(c(),p("div",W,[(c(),N(O,{onSubmit:V,ref_key:"form",ref:m,key:f.value},{default:R(()=>[(c(!0),p(S,null,T(_.value,e=>(c(),p("div",{key:e.id},[l("label",{for:"input"+e.id,style:{"padding-left":"12px","padding-right":"12px"},class:"texto-descripcion row"},[l("p",null,y(e.nombre),1),t[0]||(t[0]=j()),d(F),l("p",null,"\xDAltima lectura: "+y(e.lectura),1)],8,Z),d(I,{id:"input"+e.id,modelValue:n.value[e.id],"onUpdate:modelValue":o=>n.value[e.id]=o,outlined:"",dense:"",type:"number",rules:[o=>!!o||"Este campo es obligatorio",o=>o>=0||"No se permiten n\xFAmeros negativos",o=>o.toString().length<=15||"El n\xFAmero es demasiado grande"]},null,8,["id","modelValue","onUpdate:modelValue","rules"])]))),128)),l("div",$,[d(b,{label:"Enviar",type:"submit",color:"primary",unelevated:"",dense:""}),d(b,{label:"Cancelar",type:"reset",color:"negative",outline:"",unelevated:"",dense:"",onClick:q,class:"q-ml-sm"})])]),_:1}))]))}};var X=L(z,[["__scopeId","data-v-5d874e83"]]);export{X as F};
