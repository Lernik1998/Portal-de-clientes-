import{c4 as S,c5 as N,r as l,o as L,aT as y,ab as h,bo as i,ae as s,f as t,c6 as p,c7 as m,c8 as R,c9 as V,ca as j,ak as B,cb as F,cc as C}from"./index.fe61ee2b.js";import{Q as x}from"./QForm.831263eb.js";import{Q as I}from"./QSpace.5039b404.js";import{Q as P}from"./QPage.e3a32904.js";import{u as T}from"./use-quasar.6e3d8175.js";import{u as U}from"./ReCaptchaVuePlugin.1e4a9531.js";import{_ as A}from"./plugin-vue_export-helper.21dcd24c.js";const D={class:"user"},q={class:"user_options-container"},K={class:"user_options-forms",id:"user_options-forms"},M={style:{padding:"5%",width:"100%"},id:"login-form"},Y={class:"forms_fieldset control"},$={style:{display:"flex","justify-content":"center"}},z={__name:"LoginPage",setup(G){const r=T(),k=S(),{executeRecaptcha:g}=U(),f=N(),n=l(!1),_=l(null),v=l(0),u=l(""),c=l(""),d=l(),Q=()=>{_.value.resetValidation(),d.value="",v.value++},w=()=>{Q(),n.value=!1},E=async()=>{r.loading.show();try{const a=await g("submit_form"),e=await C.post("/validate_login.php",{recaptchaToken:a,codigo:d.value},{withCredentials:!0});e.data.success?k.push("/dashboard"):r.notify({color:"red",position:"top",message:e.data.message,icon:"report_problem"})}catch(a){console.error("Error:",a),r.notify({color:"red",position:"top",message:"Error :"+a,icon:"report_problem"})}r.loading.hide()},b=async()=>{r.loading.show(),console.log({usuario:u.value,contrase\u00F1a:f.codificar(c.value)});try{const a=await g("submit_form"),e=await C.post("/login.php",{recaptchaToken:a,usuario:u.value,contrase\u00F1a:f.codificar(c.value)},{withCredentials:!0});console.log("Verificaci\xF3n",e.data),e.data.success?n.value?r.notify({color:"green",position:"top",message:"Se ha reenviado el correo a "+u.value,icon:"mobile_screen_share"}):n.value=!0:r.notify({color:"red",position:"top",message:e.data.message,icon:"report_problem"})}catch(a){console.error("Error:",a),r.notify({color:"red",position:"top",message:"Error :"+a,icon:"report_problem"})}r.loading.hide()};return L(()=>{}),(a,e)=>(y(),h(P,{class:"pagina-login",style:{"background-image":"url('https://apiclientes.fernandomoll.es/fondo.php')"}},{default:i(()=>[s("section",D,[s("div",q,[e[5]||(e[5]=s("div",{class:"user_options-text"},[s("div",{class:"user_options-unregistered"},[s("h2",{class:"user_unregistered-title"},"No est\xE1s con nosotros?"),s("p",{class:"user_unregistered-text"},"La mejor soluci\xF3n disponible para gestionar los clientes de tu empresa."),s("button",{class:"user_unregistered-signup",id:"signup-button",onclick:"submitForm('enviar')"},"Cont\xE1ctanos")]),s("div",{class:"user_options-registered"},[s("h2",{class:"user_registered-title"},"\xBF Ya tienes una cuenta ?"),s("p",{class:"user_registered-text"},"Disfruta de tus beneficios en nuestra App accediendo."),s("button",{class:"user_registered-login",id:"login-button",onclick:"submitForm('login')"},"Login")])],-1)),s("div",K,[s("div",M,[e[4]||(e[4]=s("h2",{class:"forms_title"},"Iniciar sesi\xF3n",-1)),t(x,{onSubmit:b,class:"forms_form"},{default:i(()=>[s("fieldset",Y,[t(p,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=o=>u.value=o),label:"Correo Electr\xF3nico",type:"email",rules:[o=>!!o||"Este campo es obligatorio",o=>o.toString().length<=100||"El texto es demasiado largo"]},null,8,["modelValue","rules"]),t(p,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=o=>c.value=o),label:"Contrase\xF1a",type:"password",rules:[o=>!!o||"Este campo es obligatorio",o=>o.toString().length<=100||"El texto es demasiado largo"]},null,8,["modelValue","rules"])]),s("div",$,[t(m,{dense:"",label:"Iniciar Sesi\xF3n",type:"submit",color:"#083CC2",class:"forms_buttons-action"})])]),_:1})])])])]),t(F,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=o=>n.value=o),persistent:""},{default:i(()=>[t(R,{style:{padding:"10px"}},{default:i(()=>[t(V,null,{default:i(()=>e[6]||(e[6]=[s("p",null,"Correo enviado correctamente. Revise su bandeja de correo no deseado si no lo encuentra.",-1)])),_:1}),(y(),h(x,{onSubmit:E,ref_key:"formValidation",ref:_,key:v.value},{default:i(()=>[t(V,null,{default:i(()=>[t(p,{id:"codigo",modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value=o),label:"codigo de verificaci\xF3n",type:"number",rules:[o=>!!o||"Este campo es obligatorio",o=>o>=0||"No se permiten n\xFAmeros negativos",o=>o.toString().length<=6||"El n\xFAmero no es valido"]},null,8,["modelValue","rules"])]),_:1}),t(j,null,{default:i(()=>[t(m,{label:"Validar",type:"submit",color:"primary",class:"forms_buttons-action"}),t(m,{label:"Cancelar",type:"reset",color:"negative",outline:"",onClick:w,class:"forms_buttons-action"}),t(I),s("div",{style:{display:"flex","justify-content":"end","align-items":"center"}},[e[7]||(e[7]=B("\xBFNo has recibido el correo? ")),s("p",{onClick:b,class:"reenviar"}," Reenviar ")])]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};var oe=A(z,[["__scopeId","data-v-740c37f0"]]);export{oe as default};
